# Lightweight_Search_Engine
简易版搜索引擎

# 项目 QueryCore：一个使用 C++ 实现的轻量级搜索引擎

QueryCore 项目是一个极简主义的搜索引擎，它利用 C++17 标准从零开始精心构建。该系统专为本地文本文档的索引和检索而设计，其主要教学目标是清晰地阐述信息检索（IR）领域的基础概念。通过研究此实现，可以深入理解**倒排索引**、**词频-逆文档频率（TF-IDF）排名算法**以及**布尔查询处理**的运作原理。

## ✨ 核心功能

  * **倒排索引**：采用了一种高效的关键数据结构，它能够将词项映射到其对应的文档发布列表，从而以最小的延迟实现查询响应。

  * **TF-IDF 排名算法**：实现了经典的词频-逆文档频率（TF-IDF）算法，这是一种用于计算给定查询与语料库文档之间相关性分数的启发式方法，该分数随后决定了检索结果的排名。

  * **布尔查询处理**：系统支持 `AND` 和 `NOT` 逻辑运算符，提供了构建更高精度查询的能力（例如，`C++ AND programming NOT beginner`）。

  * **索引持久化**：提供了一种序列化机制，允许将内存中的索引结构持久化到存储介质上的二进制文件中。该索引随后可以被反序列化，从而避免了重复进行索引过程所带来的计算开销。

  * **模块化架构**：源代码以模块化的方式组织，划分了诸如分词器、索引器和查询处理器等不同组件。这种设计被认为可以增强代码的可读性和未来的可扩展性。

## 📂 架构概览

该项目遵循一种模块化的、多文件的架构范式，旨在促进可维护性并为未来的增强提供便利。其构成组件如下所示：

```
QueryCore/
|-- main.cpp             # 系统入口点与命令行界面（CLI）的实现
|-- Utils.h              # 通用工具函数
|-- Tokenizer.h/.cpp     # 用于文本预处理的词法分词器
|-- IndexData.h          # 核心数据结构定义（例如，DocInfo、PostingEntry）
|-- InvertedIndex.h/.cpp # 倒排索引的实现
|-- QueryProcessor.h/.cpp# 查询解析与结果排名逻辑
```

## 🛠️ 编译流程

本项目的成功编译取决于一个支持 C++17 的编译器；无需任何外部依赖。

**对于 Microsoft Visual Studio 集成开发环境：**

1.  在 Visual Studio 环境中实例化一个新的 C++ **控制台应用程序**项目。

2.  必须将架构概览中列举的头文件（`.h`）和源文件（`.cpp`）并入新创建的项目结构中。

3.  在项目的配置属性中，于 **C/C++ -\> 语言** 部分下，必须将 **C++ 语言标准**参数配置为 `ISO C++17 标准 (/std:c++17)` 或更高版本。

4.  随后通过“生成解决方案”命令（F7）对解决方案进行编译。

## 🚀 操作指令

编译产物执行后，将呈现一个由 `>>` 表示的命令行提示符。系统接受以下指令：

  * **目录索引**：

    ```
    # 启动对指定目录中所有 .txt 文件的索引过程。
    >> index C:\path\to\your\documents
    ```

  * **查询执行**：

    ```
    # 检索同时包含术语 "computer" 和 "science" 的文档。
    >> query computer AND science

    # 检索包含术语 "programming" 但排除术语 "java" 的文档。
    >> query programming NOT java
    ```

  * **索引持久化操作**：

    ```
    # 将当前内存中的索引序列化到指定文件。
    >> save my_index.dat

    # 从文件反序列化先前保存的索引以供后续使用。
    >> load my_index.dat
    ```

  * **辅助命令**：

    ```
    # 显示可用命令的摘要。
    >> help

    # 终止应用程序的执行。
    >> exit
    ```

## 💡 未来扩展方向

可以考虑对现有实现进行若干潜在的增强：

  * 开发一个更复杂的布尔查询解析器，能够解释 `OR` 运算符和用于控制优先级的括号分组。

  * 引入**位置索引**以支持基于短语的查询（例如，`"information retrieval"`）。

  * 将排名模型从当前的 TF-IDF 实现升级为更先进的算法，例如 **Okapi BM25**，该算法通常被认为能产生更优的相关性排名。

  * 应用索引压缩技术，例如**可变字节编码（Varint）**，以减少索引文件的静态存储占用空间。



## 核心职责与技术亮点:

架构设计与数据结构实现：设计并实现了以倒排索引为核心的数据结构，利用 std::unordered_map 实现了从词元到文档发布列表（Posting List）的高效映射。整个系统被清晰地划分为分词器(Tokenizer)、索引器(InvertedIndex) 和 查询处理器(QueryProcessor) 三大模块，体现了良好的模块化和低耦合设计。

算法研究与实现：深入研究并实现了经典的 TF-IDF 排名算法，以评估文档与查询的相关性。该实现不仅考虑了词频 (TF) 和逆文档频率 (IDF)，还通过文档长度归一化对长文档进行了权重惩罚，从而显著提升了搜索结果的排序质量。

复杂逻辑处理与Bug修复：

* 从零开始构建了一个支持 AND, OR, NOT 逻辑运算符的布尔查询解析器。通过状态机和优先级分割的逻辑，能够正确处理复杂的组合查询。

* 定位并解决了一个核心逻辑Bug：**通过细致调试，发现并解决了因索引与查询阶段分词逻辑不一致（isalnum vs. istringstream）而导致的“单次查询失败，复合查询碰巧成功”的隐蔽问题。通过重构查询处理器，强制复用Tokenizer，确保了数据处理流程的一致性，根治了该缺陷。**

现代C++与代码重构实践：

* 项目全程使用 C++17 标准，熟练运用STL容器与算法进行开发。

* 通过为Tokenizer增加接口，优雅地解决了索引（需移除停用词）与查询（需保留逻辑词）两种不同场景下的分词需求。
